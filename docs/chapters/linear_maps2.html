<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; Advanced Topics of Linear Maps – Linear Algebra</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../worksheets/matrix_representations2.html" rel="next">
<link href="../parts/linear_maps2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-273e46d7b3848a679358d7b360117b95.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head><body class="nav-sidebar floating">text: |
<style>
.problem-box {
  border-left: 4px solid #5bc0de;
  background-color: #f8f9fa;
  padding: 0;
  margin: 1rem 0;
  border-radius: 0.25rem;
}

.problem-box .problem-title {
  padding: 8px 15px;
  font-weight: bold;
  margin: 0;
  border-bottom: 1px solid #e9ecef;
  background-color: rgba(91, 192, 222, 0.1);
}

.problem-box .problem-content {
  padding: 10px 15px;
}

.problem-box-1 {
  border-color: #5bc0de;  /* Blue */
}
.problem-box-1 .problem-title {
  background-color: rgba(91, 192, 222, 0.1);
}

.problem-box-2 {
  border-color: #5cb85c;  /* Green */
}
.problem-box-2 .problem-title {
  background-color: rgba(92, 184, 92, 0.1);
}

.problem-box-3 {
  border-color: #d9534f;  /* Red */
}
.problem-box-3 .problem-title {
  background-color: rgba(217, 83, 79, 0.1);
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">




<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../parts/linear_maps2.html">Linear Transformation II</a></li><li class="breadcrumb-item"><a href="../chapters/linear_maps2.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Advanced Topics of Linear Maps</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Linear Algebra</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Linear Algebra</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vectors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Vectors in <span class="math inline">\(\mathbb{R}^n\)</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/vector_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Abstract Vector Spaces</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/computing_dot_products.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problems</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/matrix_multiplication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../applications/image_transforms_matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Real World Application</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/linear_maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Transformation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/linear_maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Transformations in <span class="math inline">\(\mathbb{R}^n\)</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/linearMapsEquations1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problems</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/system_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Systems of Linear Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/system_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Systems of Linear Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/gaussianElimination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computational Problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/alwaysSometimesNever.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conceptual Problems</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/subspaces_bases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subspaces and Bases</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/bases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Bases of Vector Spaces</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/subspaces_Rn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Subspaces of <span class="math inline">\(\mathbb{R}^n\)</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/bases_subspaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problems</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/least_squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Least Squares</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/projection_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Least Squares</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/eigenvalues.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eigenvalues and Eigenvectors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/determinants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Determinants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/eigenvalues.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Eigenvalues and Eigenvectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/quadratic_forms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../parts/linear_maps2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Transformation II</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/linear_maps2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Advanced Topics of Linear Maps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../worksheets/matrix_representations2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problems</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-change-of-basis" id="toc-sec-change-of-basis" class="nav-link active" data-scroll-target="#sec-change-of-basis"><span class="header-section-number">11.1</span> Representation of Vectors using Bases</a>
  <ul class="collapse">
  <li><a href="#computational-problems" id="toc-computational-problems" class="nav-link" data-scroll-target="#computational-problems"><span class="header-section-number">11.1.1</span> Computational Problems</a></li>
  </ul></li>
  <li><a href="#matrix-representations-of-linear-maps" id="toc-matrix-representations-of-linear-maps" class="nav-link" data-scroll-target="#matrix-representations-of-linear-maps"><span class="header-section-number">11.2</span> Matrix Representations of Linear Maps</a>
  <ul class="collapse">
  <li><a href="#computational-problems-1" id="toc-computational-problems-1" class="nav-link" data-scroll-target="#computational-problems-1"><span class="header-section-number">11.2.1</span> Computational Problems</a></li>
  <li><a href="#diagonalization-of-linear-transformations" id="toc-diagonalization-of-linear-transformations" class="nav-link" data-scroll-target="#diagonalization-of-linear-transformations"><span class="header-section-number">11.2.2</span> Diagonalization of Linear Transformations</a></li>
  </ul></li>
  <li><a href="#matrices-that-represent-the-same-linear-map" id="toc-matrices-that-represent-the-same-linear-map" class="nav-link" data-scroll-target="#matrices-that-represent-the-same-linear-map"><span class="header-section-number">11.3</span> Matrices that Represent the Same Linear Map</a>
  <ul class="collapse">
  <li><a href="#rotations-in-mathbbr3" id="toc-rotations-in-mathbbr3" class="nav-link" data-scroll-target="#rotations-in-mathbbr3"><span class="header-section-number">11.3.1</span> Rotations in <span class="math inline">\(\mathbb{R}^3\)</span></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../parts/linear_maps2.html">Linear Transformation II</a></li><li class="breadcrumb-item"><a href="../chapters/linear_maps2.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Advanced Topics of Linear Maps</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Advanced Topics of Linear Maps</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The diagonalization process we explored previously—expressing matrices as <span class="math inline">\(P^{-1}DP\)</span> with eigenvector matrix <span class="math inline">\(P\)</span> and diagonal eigenvalue matrix <span class="math inline">\(D\)</span>—takes on deeper meaning when viewed through the lens of linear transformations.</p>
<p>This perspective reveals that the same linear transformation can look different depending on our coordinate system. By changing basis, we gain the flexibility to choose the most convenient representation for a given problem, bridging the gap between abstract properties and concrete matrix representations. This powerful viewpoint is essential in both theoretical contexts and applications ranging from computer graphics to quantum mechanics.</p>
<section id="sec-change-of-basis" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sec-change-of-basis"><span class="header-section-number">11.1</span> Representation of Vectors using Bases</h2>
<p>When working with a vector space <span class="math inline">\(V\)</span> (often <span class="math inline">\(\mathbb{R}^n\)</span>), we can represent vectors using different bases. Let’s explore how the coordinate representation of a vector changes when we switch between bases.</p>
<p>Consider a vector space <span class="math inline">\(V\)</span> with two different bases:</p>
<ul>
<li><span class="math inline">\(S_1 = \{\mathbf{v}_1, \mathbf{v}_2, \ldots, \mathbf{v}_n\}\)</span></li>
<li><span class="math inline">\(S_2 = \{\mathbf{w}_1, \mathbf{w}_2, \ldots, \mathbf{w}_n\}\)</span></li>
</ul>
<p>For any vector <span class="math inline">\(\mathbf{v} \in V\)</span>, we can express it as a linear combination using either basis:</p>
<p>Using basis <span class="math inline">\(S_1\)</span>: <span class="math display">\[\mathbf{v} = c_1\mathbf{v}_1 + c_2\mathbf{v}_2 + \ldots + c_n\mathbf{v}_n\]</span></p>
<p>The coordinate vector with respect to <span class="math inline">\(S_1\)</span> is: <span class="math display">\[[\mathbf{v}]_{S_1} = \begin{bmatrix} c_1 \\ c_2 \\ \vdots \\ c_n \end{bmatrix}\]</span></p>
<p>Similarly, using basis <span class="math inline">\(S_2\)</span>: <span class="math display">\[\mathbf{v} = d_1\mathbf{w}_1 + d_2\mathbf{w}_2 + \ldots + d_n\mathbf{w}_n\]</span></p>
<p>The coordinate vector with respect to <span class="math inline">\(S_2\)</span> is: <span class="math display">\[[\mathbf{v}]_{S_2} = \begin{bmatrix} d_1 \\ d_2 \\ \vdots \\ d_n \end{bmatrix}\]</span></p>
<blockquote class="blockquote">
<p>The fundamental question is: What is the relationship between <span class="math inline">\([\mathbf{v}]_{S_1}\)</span> and <span class="math inline">\([\mathbf{v}]_{S_2}\)</span>?</p>
</blockquote>
<div id="thm-change-of-basis" class="theorem">
<p><span class="theorem-title"><strong>Theorem 11.1</strong></span> Suppose that <span class="math inline">\(V\)</span> is an <span class="math inline">\(n\)</span>-dimensional vector space with bases <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_2\)</span>. Then there exists a unique invertible matrix <span class="math inline">\(P=P_{S_1 \leftarrow S_2}\)</span> such that for every vector <span class="math inline">\(\mathbf{v} \in V\)</span> <span class="math display">\[[\mathbf{v}]_{S_1} = P[\mathbf{v}]_{S_2}\]</span></p>
<p>Moreover, this change of basis matrix can be constructed as: <span id="eq-change_of_basis"><span class="math display">\[P_{S_1 \leftarrow S_2} =
\begin{bmatrix} \uparrow &amp; \uparrow &amp; \cdots &amp; \uparrow\\
[\mathbf{w}_1]_{S_1} &amp; [\mathbf{w}_2]_{S_1} &amp; \cdots &amp; [\mathbf{w}_n]_{S_1} \\
\downarrow &amp; \downarrow &amp; \cdots&amp;\downarrow \end{bmatrix}, \tag{11.1}\]</span></span> where <span class="math inline">\(S_2=\{\mathbf{w}_1,\dots,\mathbf{w}_n\}\)</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Let <span class="math inline">\(\mathbf{v} \in V\)</span> with representation in basis <span class="math inline">\(S_2\)</span>:</p>
<p><span class="math display">\[\mathbf{v} = d_1\mathbf{w}_1 + d_2\mathbf{w}_2 + \ldots + d_n\mathbf{w}_n \quad \text{where} \quad [\mathbf{v}]_{S_2} = \begin{bmatrix} d_1 \\ d_2 \\ \vdots \\ d_n \end{bmatrix}\]</span></p>
<p>Now, we need to find <span class="math inline">\([\mathbf{v}]_{S_1}\)</span>. To do that we use <a href="bases.html#thm-coordinates" class="quarto-xref">Theorem&nbsp;<span>6.1</span></a>, that states that finding coordinates is a linear map, and <a href="matrices.html#eq-matrix-linear-combination" class="quarto-xref">Equation&nbsp;<span>3.1</span></a>, that allows to express a linear combination in <span class="math inline">\(\mathbb{R}^n\)</span> as a product of a matrix and a vector: <span class="math display">\[\begin{align}
[\mathbf{v}]_{S_1} &amp; = [d_1\mathbf{w}_1 + \ldots + d_n\mathbf{w}_n]_{S_1}\\
  &amp; = d_1[\mathbf{w}_1]_{S_1} + \ldots + d_n[\mathbf{w}_n]_{S_1}\\
  &amp; = \begin{bmatrix} \uparrow &amp; \uparrow &amp; \cdots &amp; \uparrow\\
[\mathbf{w}_1]_{S_1} &amp; [\mathbf{w}_2]_{S_1} &amp; \cdots &amp; [\mathbf{w}_n]_{S_1} \\
\downarrow &amp; \downarrow &amp; \cdots&amp;\downarrow \end{bmatrix} \begin{bmatrix} d_1 \\ d_2 \\ \vdots \\ d_n \end{bmatrix}
\end{align}\]</span> Therefore: <span class="math display">\[[\mathbf{v}]_{S_1} = P_{S_1 \leftarrow S_2} [\mathbf{v}]_{S_2},\]</span> and <span class="math inline">\(P_{S_1\leftarrow S_2}\)</span> is given by <a href="#eq-change_of_basis" class="quarto-xref">Equation&nbsp;<span>11.1</span></a></p>
</div>
<blockquote class="blockquote">
<p>If <span class="math inline">\(P=P_{S_1\leftarrow S_2}\)</span> is the change of basis matrix from <span class="math inline">\(S_2\)</span> to <span class="math inline">\(S_1\)</span>, then <span class="math inline">\(P^{-1}=P_{S_2\leftarrow S_1}\)</span> is the change of basis matrix from <span class="math inline">\(S_1\)</span> to <span class="math inline">\(S_2\)</span>. We see this easily: from the equation <span class="math inline">\([\mathbf{v}]_{S_1} = P[\mathbf{v}]_{S_2}\)</span>, we deduce that <span class="math display">\[[\mathbf{v}]_{S_2} = P^{-1}[\mathbf{v}]_{S_1}\]</span></p>
</blockquote>
<section id="computational-problems" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="computational-problems"><span class="header-section-number">11.1.1</span> Computational Problems</h3>
<p><a href="#thm-change-of-basis" class="quarto-xref">Theorem&nbsp;<span>11.1</span></a> provides not just a theoretical connection but a concrete algorithm for computing the change of basis matrix <span class="math inline">\(P\)</span>. The formula <span class="math inline">\([\mathbf{v}]_{S_1}=P[\mathbf{v}]_{S_2}\)</span> looks simple but contains all the steps needed to convert coordinates between different bases. Students should pay close attention to this formula as it shows how to solve many types of coordinate conversion problems in one compact expression.</p>
<div class="problem-box problem-box-1">
<section id="find-the-change-of-basis-matrix" class="level4 unnumbered problem-title">
<h4 class="unnumbered anchored" data-anchor-id="find-the-change-of-basis-matrix">Find the change of basis matrix</h4>
</section>
<div class="problem-content">
<p>Suppose <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_2\)</span> are given. Find the change of basis matrix from <span class="math inline">\(S_2\)</span> to <span class="math inline">\(S_1\)</span>, <span class="math inline">\(P_{S_1\leftarrow S_2}\)</span>.</p>
</div>
</div>
<p><strong>Example:</strong> Suppose <span class="math inline">\(S_1 = \{\mathbf{v}_1, \mathbf{v}_2, \mathbf{v}_3\}\)</span> and <span class="math inline">\(S_2 = \{\mathbf{w}_1, \mathbf{w}_2, \mathbf{w}_3\}\)</span> are bases of <span class="math inline">\(\mathbb{R}^3\)</span> and we are asked to find <span class="math inline">\(P_{S_1\leftarrow S_2}\)</span>.</p>
<p>From formula <a href="#eq-change_of_basis" class="quarto-xref">Equation&nbsp;<span>11.1</span></a>, we know that we need to find <span class="math inline">\([\mathbf{w}_1]_{S_1}\)</span>, <span class="math inline">\([\mathbf{w}_2]_{S_1}\)</span>, and <span class="math inline">\([\mathbf{w}_3]_{S_1}\)</span>.</p>
<p>To find <span class="math inline">\([\mathbf{w}_i]_{S_1}\)</span>, we solve the vector equation: <span class="math inline">\(x_1 \mathbf{v}_1 + x_2 \mathbf{v}_2 + x_3 \mathbf{v}_3 = \mathbf{w}_i\)</span>. We look at the augmented system and we row reduce it: <span class="math display">\[
\left[
    \begin{array}{ccc|c}
\uparrow &amp; \uparrow &amp; \uparrow &amp; \uparrow \\
\mathbf{v}_1 &amp; \mathbf{v}_2 &amp; \mathbf{v}_3 &amp; \mathbf{w}_i \\
\downarrow &amp; \downarrow &amp; \downarrow &amp; \downarrow
\end{array}\right]
\xrightarrow{\text{RREF}}
\left[\begin{array}{ccc|c}
1&amp;0&amp;0&amp;\uparrow \\
0&amp;1&amp;0 &amp; [\mathbf{w}_i]_{S_1} \\
0&amp;0&amp;1 &amp;\downarrow
\end{array}\right].
\]</span> Since <span class="math inline">\(\{\mathbf{v}_1, \mathbf{v}_2, \mathbf{v}_3\}\)</span> is a basis, the first three columns of the reduced matrix is the identity and the last column gives us the coordinates. We can combine all of them:</p>
<p><span class="math display">\[
\left[
    \begin{array}{ccc|ccc}
\uparrow &amp; \uparrow &amp; \uparrow &amp; \uparrow &amp; \uparrow &amp; \uparrow\\
\mathbf{v}_1 &amp; \mathbf{v}_2 &amp; \mathbf{v}_3 &amp; \mathbf{w}_1 &amp; \mathbf{w}_2 &amp; \mathbf{w}_3 \\
\downarrow &amp; \downarrow &amp; \downarrow &amp; \downarrow &amp; \downarrow &amp; \downarrow
\end{array}\right]
\xrightarrow{\text{RREF}}
\left[\begin{array}{ccc|ccc}
1&amp;0&amp;0&amp;\uparrow &amp;\uparrow &amp; \uparrow\\
0&amp;1&amp;0 &amp; [\mathbf{w}_1]_{S_1} &amp; [\mathbf{w}_2]_{S_1} &amp; [\mathbf{w}_3]_{S_1} \\
0&amp;0&amp;1 &amp;\downarrow &amp; \downarrow &amp; \downarrow
\end{array}\right]
\]</span> Therefore, in general, to find <span class="math inline">\(P_{S_1\leftarrow S_2}\)</span> we row reduce the augmented matrix <span class="math inline">\([S_1|S_2]\)</span> to get <span class="math inline">\([I|P_{S_1\leftarrow S_2}]\)</span>:</p>
<p><span class="math display">\[[S_1|S_2]\xrightarrow{\text{RREF}} [I|P_{S_1\leftarrow S_2}]\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(S_1\)</span> is the matrix with columns being the vectors of the first basis</li>
<li><span class="math inline">\(S_2\)</span> is the matrix with columns being the vectors of the second basis</li>
<li><span class="math inline">\(P_{S_1\leftarrow S_2}\)</span> is the change of basis matrix from <span class="math inline">\(S_2\)</span> to <span class="math inline">\(S_1\)</span></li>
</ul>
<div class="problem-box problem-box-1">
<section id="find-coordinates" class="level4 unnumbered problem-title">
<h4 class="unnumbered anchored" data-anchor-id="find-coordinates">Find coordinates</h4>
</section>
<div class="problem-content">
<p>Suppose <span class="math inline">\(S_1\)</span>, <span class="math inline">\(S_2\)</span> and <span class="math inline">\(P=P_{S_1\leftarrow S_2}\)</span> are given. If we we know the coordinates of a vector <span class="math inline">\(\mathbf{v}\in V\)</span> with respect to one basis, find the coordinates with respect to the other basis.</p>
</div>
</div>
<p>These type of problems are simpler. We just need to pay attention if we multiply by <span class="math inline">\(P\)</span> or by <span class="math inline">\(P^{-1}\)</span>. Let <span class="math inline">\(\mathbf{v}\in V\)</span>. If we know <span class="math inline">\([\mathbf{v}]_{S_2}\)</span>, then we find <span class="math inline">\([\mathbf{v}]_{S_1}\)</span> using: <span class="math display">\[[\mathbf{v}]_{S_1}=P[\mathbf{v}]_{S_2}\]</span> On the other hand, if we know <span class="math inline">\([\mathbf{v}]_{S_1}\)</span> then we find <span class="math inline">\([\mathbf{v}]_{S_2}\)</span> using: <span class="math display">\[[\mathbf{v}]_{S_2}=P^{-1}[\mathbf{v}]_{S_1}\]</span></p>
<div class="problem-box problem-box-1">
<section id="find-elements-of-a-basis" class="level4 unnumbered problem-title">
<h4 class="unnumbered anchored" data-anchor-id="find-elements-of-a-basis">Find elements of a basis</h4>
</section>
<div class="problem-content">
<p>Suppose <span class="math inline">\(S_1\)</span> and <span class="math inline">\(P=P_{S_1\leftarrow S_2}\)</span> are given. Find <span class="math inline">\(S_2\)</span>.</p>
</div>
</div>
<p><strong>Example:</strong> Suppose that</p>
<ul>
<li><span class="math inline">\(S_1 =\left\{
\begin{bmatrix}1\\1\\1\end{bmatrix},
\begin{bmatrix}1\\-1\\0\end{bmatrix},
\begin{bmatrix}1\\1\\-2\end{bmatrix}
  \right\}\)</span></li>
<li><span class="math inline">\(S_2 =\{\mathbf{w}_1,\mathbf{w}_2, \mathbf{w}_3\}\)</span>, and are bases of <span class="math inline">\(\mathbf{R^3}\)</span> and that <span class="math display">\[ P=P_{S_1\leftarrow S_2}=\begin{bmatrix}1&amp;0&amp;0\\1&amp;1&amp;0\\1&amp;1&amp;1\end{bmatrix}
\]</span> is the change of basis matrix from <span class="math inline">\(S_2\)</span> to <span class="math inline">\(S_1\)</span>. Our task is to find the elements of <span class="math inline">\(S_2\)</span>.</li>
</ul>
<p>From <a href="#eq-change_of_basis" class="quarto-xref">Equation&nbsp;<span>11.1</span></a> we know that <span class="math inline">\([\mathbf{w}_1]_{S_1}=(1,1,1)\)</span>. Then <span class="math display">\[\mathbf{w}_1=1\begin{bmatrix}1\\1\\1\end{bmatrix}+1\begin{bmatrix}1\\-1\\0\end{bmatrix}+1\begin{bmatrix}1\\1\\-2
\end{bmatrix}=\begin{bmatrix}3\\1\\-1\end{bmatrix}\]</span> Notice that we can write this as <span class="math display">\[\begin{align}\mathbf{w}_1&amp;=1\begin{bmatrix}1\\1\\1\end{bmatrix}+1\begin{bmatrix}1\\-1\\0\end{bmatrix}+1\begin{bmatrix}1\\1\\-2
\end{bmatrix}\\
&amp;=\begin{bmatrix}1&amp;1&amp;1\\1&amp;-1&amp;1\\1&amp;0&amp;2\end{bmatrix}\begin{bmatrix}1\\1\\1\end{bmatrix}
=[S_1][\mathbf{w}_1]_{S_1}
\end{align}\]</span> where <span class="math inline">\([S_1]\)</span> is the <span class="math inline">\(3\times 3\)</span> matrix with columns being the vectors of <span class="math inline">\(S_1\)</span>.</p>
<p>We can find all the vectors at once <span class="math display">\[[S_1]P=[S_1]
\begin{bmatrix}
\uparrow&amp;\uparrow&amp;\uparrow\\
[\mathbf{w}_1]_{S_1}&amp;[\mathbf{w}_2]_{S_1}&amp;[\mathbf{w}_3]_{S_1}\\
\downarrow&amp;\downarrow&amp;\downarrow\\
\end{bmatrix}=
\begin{bmatrix}
\uparrow &amp;\uparrow &amp;\uparrow\\
\mathbf{w}_1&amp;\mathbf{w}_2&amp;\mathbf{w}_3\\
\downarrow &amp;\downarrow &amp;\downarrow\\
\end{bmatrix}=[S_2]\]</span> and this works in general.</p>
</section>
</section>
<section id="matrix-representations-of-linear-maps" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="matrix-representations-of-linear-maps"><span class="header-section-number">11.2</span> Matrix Representations of Linear Maps</h2>
<p>In <a href="linear_maps.html#thm-matrix_rep" class="quarto-xref">Theorem&nbsp;<span>4.1</span></a> we showed that a linear map <span class="math inline">\(T:\mathbf{R}^n\to\mathbf{R}^n\)</span> can be written as <span class="math inline">\(T(\mathbf{x})=A\mathbf{x}\)</span>, where <span class="math inline">\(A\)</span> is the matrix <span class="math display">\[A=\begin{bmatrix}
   \uparrow &amp; \uparrow &amp; \cdots &amp; \uparrow \\
   T(\mathbf{e}_1) &amp; T(\mathbf{e}_2) &amp; \cdots &amp; T(\mathbf{e}_n) \\
   \downarrow &amp; \downarrow &amp; \cdots &amp; \downarrow \\
   \end{bmatrix}\]</span> and <span class="math inline">\(\{\mathbf{e}_1,\dots\mathbf{e}_n\}\)</span> is the canonical basis for <span class="math inline">\(\mathbb{R}^n\)</span>.</p>
<p>In this section we show that a similar result works for general linear maps on general vector spaces with a fixed basis. The idea of the proof is the same but the result is presented in terms of coordinates.</p>
<div id="thm-matrix-rep-general" class="theorem">
<p><span class="theorem-title"><strong>Theorem 11.2</strong></span> Suppose that <span class="math inline">\(V\)</span> is an <span class="math inline">\(n\)</span> dimensional vector space with basis <span class="math inline">\(S=\{\mathbf{e}_1,\dots\mathbf{e}_n\}\)</span>. If <span class="math inline">\(T:V\to V\)</span> is a linear map, there exists a unique matrix <span class="math inline">\(A\)</span> such that for every <span class="math inline">\(\mathbf{v}\in V\)</span>, <span class="math display">\[[T(\mathbf{v})]_S=A[\mathbf{v}]_S\]</span> Moreover, the matrix representation of <span class="math inline">\(T\)</span> with respect to the basis <span class="math inline">\(S\)</span> is given by <span id="eq-matrix-representation"><span class="math display">\[A =
\begin{bmatrix} \uparrow &amp; \uparrow &amp; \cdots &amp; \uparrow\\
[T(\mathbf{v}_1)]_S &amp; [T(\mathbf{v}_2)]_{S} &amp; \cdots &amp; [T(\mathbf{v}_n)]_{S} \\
\downarrow &amp; \downarrow &amp; \cdots&amp;\downarrow \end{bmatrix}. \tag{11.2}\]</span></span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Let <span class="math inline">\(\mathbf{v} \in V\)</span> with representation in basis <span class="math inline">\(S\)</span>: <span class="math display">\[\mathbf{v} = x_1\mathbf{v}_1 + x_2\mathbf{v}_2 + \ldots + x_n\mathbf{v}_n \quad \text{where} \quad [\mathbf{v}]_{S} = \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{bmatrix}\]</span> Since <span class="math inline">\(T\)</span> is linear <span class="math display">\[
\begin{align}T(\mathbf{v}) &amp;=T(x_1\mathbf{v}_1 + x_2\mathbf{v}_2 + \ldots + x_n\mathbf{v}_n)\\
&amp;= x_1T(\mathbf{v}_1) + x_2T(\mathbf{v}_2) + \ldots + x_nT(\mathbf{v}_n).
\end{align}
\]</span> Then we find the coordinates of <span class="math inline">\(T(\mathbf{v})\)</span> using <a href="bases.html#thm-coordinates" class="quarto-xref">Theorem&nbsp;<span>6.1</span></a> (finding coordinates is a linear map) and <a href="matrices.html#eq-matrix-linear-combination" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> to find the matrix representation: <span class="math display">\[
\begin{align}
[T(\mathbf{v})]_S &amp;= [x_1T(\mathbf{v}_1) + x_2T(\mathbf{v}_2) + \ldots + x_nT(\mathbf{v}_n)]_S\\
&amp;=x_1[T(\mathbf{v}_1)]_S + x_2[T(\mathbf{v}_2)]_S + \ldots + x_n[T(\mathbf{v}_n)]_S\\
&amp;= \begin{bmatrix} \uparrow &amp; \uparrow &amp; \cdots &amp; \uparrow\\
[T(\mathbf{v}_1)]_{S} &amp; [T(\mathbf{v}_2)]_{S} &amp; \cdots &amp; [T(\mathbf{v}_n)]_{S} \\
\downarrow &amp; \downarrow &amp; \cdots&amp;\downarrow \end{bmatrix}
\begin{bmatrix}x_1\\x_2\\\vdots\\x_n\end{bmatrix}=A[\mathbf{v}]_S.
\end{align}
\]</span> This concludes the proof <span class="math inline">\(\square\)</span></p>
</div>
<section id="computational-problems-1" class="level3" data-number="11.2.1">
<h3 data-number="11.2.1" class="anchored" data-anchor-id="computational-problems-1"><span class="header-section-number">11.2.1</span> Computational Problems</h3>
<p>Like before, <a href="#thm-matrix-rep-general" class="quarto-xref">Theorem&nbsp;<span>11.2</span></a> provides not just a theoretical connection but a concrete algorithm for computing the matrix representation <span class="math inline">\(A\)</span>. The formula <span class="math inline">\([T(\mathbf{v})]_{S}=A[\mathbf{v}]_{S}\)</span> contains a lot of information. Students should pay close attention to it.</p>
<div class="problem-box problem-box-1">
<section id="find-the-matrix-representation" class="level4 unnumbered problem-title">
<h4 class="unnumbered anchored" data-anchor-id="find-the-matrix-representation">Find the matrix representation</h4>
</section>
<div class="problem-content">
<p>Suppose that a linear map <span class="math inline">\(T:\mathbb{R}^n\to\mathbb{R}^n\)</span> and a basis <span class="math inline">\(S=\{\mathbf{v}_1,\dots,\mathbf{v}_n\}\)</span> of <span class="math inline">\(\mathbf{R}^n\)</span> are given. Find the matrix representation <span class="math inline">\(A\)</span>.</p>
</div>
</div>
<p><strong>Example:</strong> Suppose <span class="math inline">\(S = \{\mathbf{v}_1, \mathbf{v}_2, \mathbf{v}_3\}\)</span> is a basis of <span class="math inline">\(\mathbb{R}^3\)</span> and that <span class="math inline">\(T:\mathbb{R}^3\to\mathbb{R}^3\)</span> is a linear map. We are asked to find the matrix representation of <span class="math inline">\(T\)</span> with respect to <span class="math inline">\(S\)</span>, which we call <span class="math inline">\(A\)</span>.</p>
<p>From <a href="#thm-matrix-rep-general" class="quarto-xref">Theorem&nbsp;<span>11.2</span></a>, we know that we need to find <span class="math inline">\([T(\mathbf{v}_1)]_{S}\)</span>, <span class="math inline">\([T(\mathbf{v}_2)]_{S}\)</span>, and <span class="math inline">\([T(\mathbf{v}_3)]_{S}\)</span>.</p>
<p>To find <span class="math inline">\([T(\mathbf{v}_i)]_{S}\)</span>, we solve the vector equation: <span class="math inline">\(x_1 \mathbf{v}_1 + x_2 \mathbf{v}_2 + x_3 \mathbf{v}_3 = T(\mathbf{v}_i)\)</span>. We look at the augmented system and we row reduce it: <span class="math display">\[
\left[
    \begin{array}{ccc|c}
\uparrow &amp; \uparrow &amp; \uparrow &amp; \uparrow \\
\mathbf{v}_1 &amp; \mathbf{v}_2 &amp; \mathbf{v}_3 &amp; T(\mathbf{v}_i) \\
\downarrow &amp; \downarrow &amp; \downarrow &amp; \downarrow
\end{array}\right]
\xrightarrow{\text{RREF}}
\left[\begin{array}{ccc|c}
1&amp;0&amp;0&amp;\uparrow \\
0&amp;1&amp;0 &amp; [T(\mathbf{v}_i)]_{S} \\
0&amp;0&amp;1 &amp;\downarrow
\end{array}\right].
\]</span> Since <span class="math inline">\(\{\mathbf{v}_1, \mathbf{v}_2, \mathbf{v}_3\}\)</span> is a basis, the first three columns of the reduced matrix is the identity and the last column gives us the coordinates of <span class="math inline">\(T(\mathbf{v}_i)\)</span>. We can combine all of them:</p>
<p><span class="math display">\[
\left[
    \begin{array}{ccc|ccc}
\uparrow &amp; \uparrow &amp; \uparrow &amp; \uparrow &amp; \uparrow &amp; \uparrow\\
\mathbf{v}_1 &amp; \mathbf{v}_2 &amp; \mathbf{v}_3 &amp; T(\mathbf{v}_1) &amp; T(\mathbf{v}_2) &amp; T(\mathbf{v}_3) \\
\downarrow &amp; \downarrow &amp; \downarrow &amp; \downarrow &amp; \downarrow &amp; \downarrow
\end{array}\right]
\xrightarrow{\text{RREF}}
\left[\begin{array}{ccc|ccc}
1&amp;0&amp;0&amp;\uparrow &amp;\uparrow &amp; \uparrow\\
0&amp;1&amp;0 &amp; [T(\mathbf{v}_1)]_{S} &amp; [T(\mathbf{v}_2)]_{S} &amp; [T(\mathbf{v}_3)]_{S} \\
0&amp;0&amp;1 &amp;\downarrow &amp; \downarrow &amp; \downarrow
\end{array}\right]
\]</span> Therefore, in general, to find <span class="math inline">\(A\)</span> we row reduce the augmented matrix <span class="math inline">\([S|T(S)]\)</span> to get <span class="math inline">\([I|A]\)</span>:</p>
<p><span class="math display">\[[S|T(S)]\xrightarrow{\text{RREF}} [I|A]\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(S\)</span> is the matrix with columns being the vectors of the basis</li>
<li><span class="math inline">\(T(S)\)</span> is the matrix with columns being <span class="math inline">\(T\)</span> applied to the vectors of the basis</li>
<li><span class="math inline">\(A\)</span> is the matrix representation of <span class="math inline">\(T\)</span> with respect to <span class="math inline">\(S\)</span></li>
</ul>
<div class="problem-box problem-box-1">
<section id="find-tmathbfv" class="level4 unnumbered problem-title">
<h4 class="unnumbered anchored" data-anchor-id="find-tmathbfv">Find <span class="math inline">\(T(\mathbf{v})\)</span></h4>
</section>
<div class="problem-content">
<p>Suppose <span class="math inline">\(S\)</span> is a basis of <span class="math inline">\(\mathbb{R}^n\)</span> and that <span class="math inline">\(A\)</span> is the matrix representation of a linear map <span class="math inline">\(T:\mathbb{R}^n\to\mathbb{R}^n\)</span>. If <span class="math inline">\(\mathbf{v}\in\mathbb{R}^n\)</span>, we need to find <span class="math inline">\(T(\mathbf{v})\)</span></p>
</div>
</div>
<p><strong>Example:</strong> Suppose that <span class="math display">\[S =\left\{
  \begin{bmatrix}1\\1\\1\end{bmatrix},
  \begin{bmatrix}1\\-1\\0\end{bmatrix},
  \begin{bmatrix}1\\1\\-2\end{bmatrix}
    \right\}\]</span> is a basis of <span class="math inline">\(\mathbf{R^3}\)</span> and that <span class="math inline">\(T:\mathbb{R}^3\to\mathbb{R}^3\)</span> is a linear map with matrix represenation with respect to <span class="math inline">\(S\)</span> given by <span class="math display">\[ A=\begin{bmatrix}1&amp;0&amp;0\\1&amp;1&amp;0\\1&amp;1&amp;1\end{bmatrix}.\]</span> Let <span class="math inline">\(\mathbf{v}=(1,1,0)\)</span>. We need to find <span class="math inline">\(T(1,1,0)\)</span>.</p>
<p>From <a href="#thm-matrix-rep-general" class="quarto-xref">Theorem&nbsp;<span>11.2</span></a> we know that <span class="math inline">\([T(\mathbf{v})]_S=A[\mathbf{v}]_S\)</span>. This formula outlines the steps that we need to take. We should not memorize them, we should read them from the formula. We have <span class="math inline">\(\mathbf{v}\)</span></p>
<ul>
<li>First, we need to find <span class="math inline">\([\mathbf{v}]_S\)</span></li>
<li>Then, multiplying <span class="math inline">\([\mathbf{v}]_S\)</span> by <span class="math inline">\(A\)</span> we get <span class="math inline">\([T(\mathbf{v})]_S\)</span></li>
<li>Finally we find <span class="math inline">\(T(\mathbf{v})\)</span></li>
</ul>
<p>To find <span class="math inline">\([\mathbf{v}]_S\)</span>, we look at the augmented system and row reduce it <span class="math display">\[\left[\begin{array}{ccc|c}
1&amp;1&amp;1&amp;1\\1&amp;-1&amp;1&amp;1\\1&amp;0&amp;-2&amp;0
\end{array}\right]
\xrightarrow{\text{RREF}}
\left[\begin{array}{ccc|c}
1&amp;0&amp;0&amp;2\\0&amp;1&amp;0&amp;0\\0&amp;0&amp;1&amp;-1
\end{array}\right]
\]</span> and we get that <span class="math inline">\([(1,1,0)]_S=(2,0,-1)\)</span>. Now we multiply the coordinates by <span class="math inline">\(A\)</span> to find the coordinates of <span class="math inline">\(T(\mathbf{v})\)</span> <span class="math display">\[
[T(\mathbf{v})]_S=A[\mathbf{v}]_S
=A\begin{bmatrix}1&amp;0&amp;0\\1&amp;1&amp;0\\1&amp;1&amp;1\end{bmatrix}
\begin{bmatrix}2\\0\\-1\end{bmatrix}=
\begin{bmatrix}2\\2\\1\end{bmatrix}
\]</span> Then <span class="math display">\[T(\mathbf{v})=
2 \begin{bmatrix}1\\1\\1\end{bmatrix}+
2 \begin{bmatrix}1\\-1\\0\end{bmatrix}+
  \begin{bmatrix}1\\1\\-2\end{bmatrix}
  =\begin{bmatrix}5\\1\\0\end{bmatrix}
\]</span></p>
</section>
<section id="diagonalization-of-linear-transformations" class="level3" data-number="11.2.2">
<h3 data-number="11.2.2" class="anchored" data-anchor-id="diagonalization-of-linear-transformations"><span class="header-section-number">11.2.2</span> Diagonalization of Linear Transformations</h3>
<p>When studying linear transformations on vector spaces, we often seek simple matrix representations. In some cases, we can find bases that yield diagonal matrices, which significantly simplifies calculations. The following Theorem characterizes the transformations that allow for such representations:</p>
<p>I’ll clean up the proof while maintaining its logical structure.</p>
<div class="theorem">
<p><strong>Theorem:</strong> A linear transformation <span class="math inline">\(T: V \to V\)</span> is diagonalizable if and only if there exists a basis for <span class="math inline">\(V\)</span> consisting entirely of eigenvectors of <span class="math inline">\(T\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>(<span class="math inline">\(\Rightarrow\)</span>) Suppose that the matrix representation of <span class="math inline">\(T:V\to V\)</span> with respect to the basis <span class="math inline">\(S=\{\mathbf{v}_1,\dots,\mathbf{v}_n\}\)</span> is diagonal: <span class="math display">\[\begin{bmatrix}
λ_1 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; λ_2 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; λ_n
\end{bmatrix}\]</span></p>
<p>From <a href="#eq-matrix-representation" class="quarto-xref">Equation&nbsp;<span>11.2</span></a>, we know that the <span class="math inline">\(j\)</span>th column of this matrix gives the coordinates of <span class="math inline">\(T(\mathbf{v}_j)\)</span> in terms of the basis <span class="math inline">\(S\)</span>. Thus, <span class="math inline">\([T(\mathbf{v}_j)]_S\)</span> has <span class="math inline">\(λ_j\)</span> in the <span class="math inline">\(j\)</span>th position and zeros elsewhere, which means <span class="math inline">\(T(\mathbf{v}_j)=λ_j\mathbf{v}_j\)</span> for each <span class="math inline">\(j=1,2,\ldots,n\)</span>. Therefore, each basis vector <span class="math inline">\(\mathbf{v}_j\)</span> is an eigenvector of <span class="math inline">\(T\)</span> with corresponding eigenvalue <span class="math inline">\(λ_j\)</span>.</p>
<p>(<span class="math inline">\(\Leftarrow\)</span>) Conversely, if <span class="math inline">\(S=\{\mathbf{v}_1,\dots,\mathbf{v}_n\}\)</span> is a basis of eigenvectors with <span class="math inline">\(T(\mathbf{v}_j)=λ_j\mathbf{v}_j\)</span>, then the matrix representation with respect to this basis must be diagonal with the eigenvalues on the main diagonal.</p>
</div>
</section>
</section>
<section id="matrices-that-represent-the-same-linear-map" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="matrices-that-represent-the-same-linear-map"><span class="header-section-number">11.3</span> Matrices that Represent the Same Linear Map</h2>
<p>Let <span class="math inline">\(V\)</span> be a vector space with bases <span class="math inline">\(S_1 = \{\mathbf{v}_1, \mathbf{v}_2, \ldots, \mathbf{v}_n\}\)</span> and <span class="math inline">\(S_2 = \{\mathbf{w}_1, \mathbf{w}_2, \ldots, \mathbf{w}_n\}\)</span> and let <span class="math inline">\(T:V\to V\)</span> be a linear map. From <a href="#thm-matrix-rep-general" class="quarto-xref">Theorem&nbsp;<span>11.2</span></a> there exist unique matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> such that for every <span class="math inline">\(\mathbf{v}\in V\)</span> <span class="math display">\[[T(\mathbf{v})]_{S_1}=A[\mathbf{v}]_{S_1}\quad\text{ and }\quad [T(\mathbf{v})]_{S_2}=B[\mathbf{v}]_{S_2}.\]</span></p>
<blockquote class="blockquote">
<p>Since <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> represent the same linear map with respect to a different set of bases, they have to be related. In this section we study this relationship.</p>
</blockquote>
<p>From <a href="#thm-change-of-basis" class="quarto-xref">Theorem&nbsp;<span>11.1</span></a> there exists a unique matrix <span class="math inline">\(P=P_{S_1\leftarrow S_2}\)</span> such that for every <span class="math inline">\(\mathbf{z}\in V\)</span> <span class="math display">\[[\mathbf{z}]_{S_1}=P[\mathbf{z}].\]</span> Applying this formula to <span class="math inline">\(\mathbf{v}\)</span> and <span class="math inline">\(T(\mathbf{v})\)</span> and multiplying by <span class="math inline">\(P^{-1}\)</span> we get: <span class="math display">\[\begin{align}
[T(\mathbf{v})]_{S_1} &amp;= A[\mathbf{v}]_{S_1}\\
P[T(\mathbf{v})]_{S_2} &amp;= AP[\mathbf{v}]_{S_2}\\
[T(\mathbf{v})]_{S_2} &amp;= P^{-1}AP[\mathbf{v}]_{S_2}.
\end{align}\]</span> Since <span class="math inline">\(B\)</span> is unique we obtain that <span id="eq-similar-matrices"><span class="math display">\[B=P^{-1}AP\quad\text{ or equivalently }\quad A=PBP^{-1} \tag{11.3}\]</span></span></p>
<p>This motivates the following definition:</p>
<div id="def-similarity" class="definition theorem">
<p><span class="theorem-title"><strong>Definition 11.1</strong></span> Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be <span class="math inline">\(n\times n\)</span> matrices. We say that <span class="math inline">\(A\)</span> is <em>similar</em> to <span class="math inline">\(B\)</span> if there exists an invertible matrix <span class="math inline">\(P\)</span> such that <span class="math inline">\(B=P^{-1}AP\)</span>.</p>
</div>
<p>Similarity forms an equivalence relation between square matrices. First, the relation is symmetric: if <span class="math inline">\(B=P^{-1}AP\)</span>, then by multiplying both sides by <span class="math inline">\(P\)</span> on the right and <span class="math inline">\(P^{-1}\)</span> on the left, we get <span class="math inline">\(A=PBP^{-1}\)</span>, showing that <span class="math inline">\(B\)</span> is also similar to <span class="math inline">\(A\)</span>.</p>
<p>The relation is reflexive because every square matrix <span class="math inline">\(A\)</span> is similar to itself via the identity matrix: <span class="math inline">\(A=I^{-1}AI\)</span>.</p>
<p>Finally, similarity is transitive: if <span class="math inline">\(A\)</span> is similar to <span class="math inline">\(B\)</span> with <span class="math inline">\(B=P^{-1}AP\)</span>, and <span class="math inline">\(B\)</span> is similar to <span class="math inline">\(C\)</span> with <span class="math inline">\(C=Q^{-1}BQ\)</span>, then substituting gives <span class="math inline">\(C=Q^{-1}(P^{-1}AP)Q=(PQ)^{-1}A(PQ)\)</span>. This shows that <span class="math inline">\(A\)</span> is similar to <span class="math inline">\(C\)</span> via the invertible matrix <span class="math inline">\(PQ\)</span>, thereby establishing similarity as an equivalence relation.</p>
<p>Our explanation also provided a proof of the following theorem:</p>
<div id="thm-change-of-basis-representations" class="theorem">
<p><span class="theorem-title"><strong>Theorem 11.3</strong></span> Let <span class="math inline">\(V\)</span> be a vector space with bases <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_2\)</span> and let <span class="math inline">\(T:V\to V\)</span> be a linear map. Then the matrix representations of <span class="math inline">\(T\)</span> with respect to <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_2\)</span> are similar. More precisely, if <span class="math inline">\(P\)</span> is the change of basis matrix from <span class="math inline">\(S_2\)</span> to <span class="math inline">\(S_1\)</span>, <span class="math inline">\(A\)</span> is the matrix representation of <span class="math inline">\(T\)</span> with respect to <span class="math inline">\(S_1\)</span> and <span class="math inline">\(B\)</span> is the matrix representation of <span class="math inline">\(T\)</span> with respect to <span class="math inline">\(S_2\)</span>, then <span class="math inline">\(B=P^{-1}AP\)</span>.</p>
</div>
<section id="rotations-in-mathbbr3" class="level3" data-number="11.3.1">
<h3 data-number="11.3.1" class="anchored" data-anchor-id="rotations-in-mathbbr3"><span class="header-section-number">11.3.1</span> Rotations in <span class="math inline">\(\mathbb{R}^3\)</span></h3>
<p>We will illustrate <a href="#thm-change-of-basis-representations" class="quarto-xref">Theorem&nbsp;<span>11.3</span></a> finding matrix representations of 3D rotations.</p>
<p>Let’s start with a simpler example in <span class="math inline">\(\mathbb{R}^2\)</span> that we have discussed before</p>
<p><strong>Example 1:</strong> Let <span class="math inline">\(T\)</span> be the rotation by <span class="math inline">\(\theta\)</span> degrees in <span class="math inline">\(\mathbb{R}^2\)</span>. The matrix representation with respect to the canonical basis is <span class="math display">\[\begin{bmatrix}\cos(\theta) &amp;-\sin(\theta)\\\sin(\theta)&amp;\cos(\theta)\end{bmatrix}\]</span></p>
<p>This matrix represents a counterclockwise rotation by <span class="math inline">\(\theta\)</span> degrees around the origin in a two-dimensional space. When we multiply this matrix by any vector in <span class="math inline">\(\mathbb{R}^2\)</span>, it rotates the vector by the angle <span class="math inline">\(\theta\)</span> while preserving its length.</p>
<p>The canonical basis in <span class="math inline">\(\mathbb{R}^2\)</span> consists of the unit vectors <span class="math inline">\(\mathbf{e}_1 = (1,0)\)</span> and <span class="math inline">\(\mathbf{e}_2 = (0,1)\)</span>. When rotated by <span class="math inline">\(\theta\)</span> degrees:</p>
<ul>
<li><span class="math inline">\(\mathbf{e}_1\)</span> becomes <span class="math inline">\((\cos(\theta), \sin(\theta))\)</span>, which forms the first column of the matrix</li>
<li><span class="math inline">\(\mathbf{e}_2\)</span> becomes <span class="math inline">\((-\sin(\theta), \cos(\theta))\)</span>, which forms the second column</li>
</ul>
<p><strong>Example 2:</strong> Rotation by <span class="math inline">\(\theta\)</span> degrees about the x-axis in <span class="math inline">\(\mathbb{R}^3\)</span> has matrix representation: <span class="math display">\[\begin{bmatrix}1 &amp; 0 &amp; 0 \\ 0 &amp; \cos(\theta) &amp; -\sin(\theta) \\ 0 &amp; \sin(\theta) &amp; \cos(\theta)\end{bmatrix}\]</span></p>
<p>This matrix keeps the x-coordinate unchanged while rotating the yz-plane by angle <span class="math inline">\(\theta\)</span>.</p>
<p><strong>Example 3:</strong> Rotation by <span class="math inline">\(\theta\)</span> degrees about the y-axis in <span class="math inline">\(\mathbb{R}^3\)</span> has matrix representation: <span class="math display">\[\begin{bmatrix}\cos(\theta) &amp; 0 &amp; \sin(\theta) \\ 0 &amp; 1 &amp; 0 \\ -\sin(\theta) &amp; 0 &amp; \cos(\theta)\end{bmatrix}\]</span></p>
<p>This transformation preserves the y-coordinate while rotating the xz-plane by angle <span class="math inline">\(\theta\)</span>.</p>
<p><strong>Example 4:</strong> Let <span class="math inline">\(T\)</span> be the 3D-rotation by <span class="math inline">\(\theta\)</span> degrees about the axis <span class="math inline">\((1,1,1)\)</span>. Find the matrix representation of <span class="math inline">\(T\)</span> with respect to the standard basis.</p>
<p>This is a more challenging problem because we can’t immediately determine how the rotation affects the standard basis vectors. A better approach is to use a change of basis strategy: first select a new coordinate system where one axis aligns with the rotation axis <span class="math inline">\((1,1,1)\)</span>, compute the rotation matrix in this convenient basis, and then transform it back to the standard basis using a change of basis matrix.</p>
<p>In the aligned coordinate system, the rotation will have a simple form since the vector <span class="math inline">\((1,1,1)\)</span> remains fixed while vectors in the perpendicular plane rotate. We can use the similarity transformation <span class="math inline">\(A = PBP^{-1}\)</span> where <span class="math inline">\(P\)</span> is the change of basis matrix, <span class="math inline">\(B\)</span> represents the rotation in the aligned coordinates, and <span class="math inline">\(A\)</span> is our desired rotation matrix in the standard basis.</p>
<p>This technique is widely used in computer graphics, where rotations around arbitrary axes are essential for realistic 3D animations, camera movements, and object manipulations. While modern graphics engines often implement these operations using quaternions for better computational efficiency and to avoid issues, the underlying mathematical foundation remains the same.</p>
<p><strong>Step 1: Find the new coordinate system:</strong> We first find an orthonormal basis where one vector aligns with the rotation vector <span class="math inline">\((1,1,1)\)</span>: <span class="math display">\[S_2=\left\{
    \begin{bmatrix}\frac{1}{\sqrt{3}}\\\frac{1}{\sqrt{3}}\\\frac{1}{\sqrt{3}}\end{bmatrix}\\
    \begin{bmatrix}\frac{1}{\sqrt{2}}\\\frac{-1}{\sqrt{2}}\\0\end{bmatrix}\\
    \begin{bmatrix}\frac{1}{\sqrt{6}}\\\frac{1}{\sqrt{6}}\\\frac{-2}{\sqrt{6}}\end{bmatrix}\\
\right\}\]</span></p>
<p>In this case we see that the matrix representation of <span class="math inline">\(T\)</span> with respect <span class="math inline">\(S_2\)</span> is <span class="math display">\[B=\begin{bmatrix}1 &amp; 0 &amp; 0 \\ 0 &amp; \cos(\theta) &amp; -\sin(\theta) \\ 0 &amp; \sin(\theta) &amp; \cos(\theta)\end{bmatrix}\]</span> This matrix keeps the first vector fixed and it rotates the perpendicular plane by <span class="math inline">\(\theta\)</span> degrees, which is exactly what we want for a rotation around the <span class="math inline">\((1,1,1)\)</span> axis.</p>
<p>This approach works precisely because <span class="math inline">\(S_2\)</span>​ is an orthonormal basis. The orthonormality ensures that the transformation preserves angles and distances in the new coordinate system, which is essential for a proper rotation. Without orthonormality, the transformation would introduce distortion, and we could no longer interpret it as a pure rotation.</p>
<p><strong>Step 2: Find the change of basis matrix:</strong> We now find <span class="math inline">\(Q=P_{S_1\leftarrow S_2}\)</span>, the change of basis matrix from <span class="math inline">\(S_2\)</span> to the canonical basis <span class="math inline">\(S_1=\{\mathbf{e}_1,\mathbf{e}_2,\mathbf{e}_3\}\)</span>. Since we are transitioning to the canonical basis, for every element of <span class="math inline">\(S_2\)</span>, <span class="math inline">\([\mathbf{w}_i]_{S_1}=\mathbf{w}_i\)</span> and from <a href="#eq-change_of_basis" class="quarto-xref">Equation&nbsp;<span>11.1</span></a> we see that <span class="math display">\[Q=\begin{bmatrix}
\frac{1}{\sqrt{3}} &amp; \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{6}}\\
\frac{1}{\sqrt{3}} &amp; \frac{-1}{\sqrt{2}} &amp; \frac{1}{\sqrt{6}}\\
\frac{1}{\sqrt{3}} &amp; 0 &amp; \frac{-2}{\sqrt{6}}.\\
\end{bmatrix}\]</span></p>
<p>The orthonormality of <span class="math inline">\(S_2\)</span> makes the change of basis matrix orthogonal, since all the columns are orthonormal. This means that the inverse of <span class="math inline">\(Q\)</span> is transpose, which significantly simplifies the calculations when transforming back to the standard basis.</p>
<p><strong>Step 3: Transform back to the standard basis:</strong> <a href="#thm-change-of-basis-representations" class="quarto-xref">Theorem&nbsp;<span>11.3</span></a> says that the matrix representation of <span class="math inline">\(T\)</span> with respect to the canonical basis <span class="math inline">\(S_1\)</span> is <span class="math inline">\(A=QBQ^T\)</span>: <span class="math display">\[A=\begin{bmatrix}
\frac{1}{\sqrt{3}} &amp; \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{6}}\\
\frac{1}{\sqrt{3}} &amp; \frac{-1}{\sqrt{2}} &amp; \frac{1}{\sqrt{6}}\\
\frac{1}{\sqrt{3}} &amp; 0 &amp; \frac{-2}{\sqrt{6}}.\\
\end{bmatrix}
\begin{bmatrix}1 &amp; 0 &amp; 0 \\ 0 &amp; \cos(\theta) &amp; -\sin(\theta) \\ 0 &amp; \sin(\theta) &amp; \cos(\theta)\end{bmatrix}
\begin{bmatrix}
\frac{1}{\sqrt{3}} &amp; \frac{1}{\sqrt{3}} &amp; \frac{1}{\sqrt{3}}\\
\frac{1}{\sqrt{2}} &amp; \frac{-1}{\sqrt{2}} &amp; 0\\
\frac{1}{\sqrt{6}} &amp; \frac{1}{\sqrt{6}} &amp; \frac{-2}{\sqrt{6}}
\end{bmatrix}
\]</span> When we simplify this expression using SymPy we get that <span class="math display">\[A= \begin{bmatrix}\frac{2 \cos{\left(θ \right)}}{3} + \frac{1}{3} &amp; \frac{1}{3} - \frac{2 \sin{\left(θ + \frac{\pi}{6} \right)}}{3} &amp; \frac{1}{3} - \frac{2 \cos{\left(θ + \frac{\pi}{3} \right)}}{3}\\\frac{1}{3} - \frac{2 \cos{\left(θ + \frac{\pi}{3} \right)}}{3} &amp; \frac{2 \cos{\left(θ \right)}}{3} + \frac{1}{3} &amp; \frac{1}{3} - \frac{2 \sin{\left(θ + \frac{\pi}{6} \right)}}{3}\\\frac{1}{3} - \frac{2 \sin{\left(θ + \frac{\pi}{6} \right)}}{3} &amp; \frac{1}{3} - \frac{2 \cos{\left(θ + \frac{\pi}{3} \right)}}{3} &amp; \frac{2 \cos{\left(θ \right)}}{3} + \frac{1}{3}\end{bmatrix}.\]</span></p>
<p>This is the SymPy code:</p>
<div id="a70c95bf" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>init_printing()</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the orthonormal vectors of S2</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>V1<span class="op">=</span>Matrix([<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>])<span class="op">/</span>sqrt(<span class="dv">3</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>V2<span class="op">=</span>Matrix([<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>])<span class="op">/</span>sqrt(<span class="dv">2</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>V3<span class="op">=</span>Matrix([<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>])<span class="op">/</span>sqrt(<span class="dv">6</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the change of basis mstrix Q</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> Matrix.hstack(V1,V2,V3)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define B, matrix representation of T with respect to S2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>θ <span class="op">=</span> Symbol(<span class="st">'θ'</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> Matrix([[<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">0</span>,cos(θ),<span class="op">-</span>sin(θ)],[<span class="dv">0</span>,sin(θ),cos(θ)]])</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the matrix representation with respect to the standard basis and simplify</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>simplify(Q<span class="op">*</span>B<span class="op">*</span>Q.T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}\frac{2 \cos{\left(θ \right)}}{3} + \frac{1}{3} &amp; \frac{1}{3} - \frac{2 \sin{\left(θ + \frac{\pi}{6} \right)}}{3} &amp; \frac{1}{3} - \frac{2 \cos{\left(θ + \frac{\pi}{3} \right)}}{3}\\\frac{1}{3} - \frac{2 \cos{\left(θ + \frac{\pi}{3} \right)}}{3} &amp; \frac{2 \cos{\left(θ \right)}}{3} + \frac{1}{3} &amp; \frac{1}{3} - \frac{2 \sin{\left(θ + \frac{\pi}{6} \right)}}{3}\\\frac{1}{3} - \frac{2 \sin{\left(θ + \frac{\pi}{6} \right)}}{3} &amp; \frac{1}{3} - \frac{2 \cos{\left(θ + \frac{\pi}{3} \right)}}{3} &amp; \frac{2 \cos{\left(θ \right)}}{3} + \frac{1}{3}\end{matrix}\right]\)</span></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../parts/linear_maps2.html" class="pagination-link" aria-label="Linear Transformation II">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Linear Transformation II</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../worksheets/matrix_representations2.html" class="pagination-link" aria-label="Problems">
        <span class="nav-page-text">Problems</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>